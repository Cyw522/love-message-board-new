<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ˜¥å¨‡ä¸å¿—æ˜</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* ç²’å­æ•ˆæœç›¸å…³æ ·å¼ */
        .sparkle {
            position: absolute;
            background-color: #fff;
            border-radius: 50%;
            pointer-events: none;
            opacity: 1;
        }
        
        .heart-particle {
            position: absolute;
            pointer-events: none;
            opacity: 1;
            font-size: 16px;
        }
        
        /* ä¼˜åŒ–æŒ‰é’®äº¤äº’çš„åŠ¨ç”» */
        @keyframes buttonPulse {
            0% {
                transform: scale(1);
                box-shadow: 0 0 20px rgba(255, 46, 99, 0.8);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 0 30px rgba(255, 46, 99, 1);
            }
            100% {
                transform: scale(1);
                box-shadow: 0 0 20px rgba(255, 46, 99, 0.8);
            }
        }
        
        #yes-button:hover {
            animation: buttonPulse 1s ease-in-out infinite;
        }
        
        /* éŸ³ä¹æ§åˆ¶æŒ‰é’®æ ·å¼ */
        .music-control {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background-color: rgba(255, 46, 99, 0.8);
            border-radius: 50%;
            display: none; /* éšè—éŸ³ä¹æ§åˆ¶æŒ‰é’® */
            justify-content: center;
            align-items: center;
            cursor: pointer;
            z-index: 100;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(255, 46, 99, 0.8);
        }
        
        .music-control:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(255, 46, 99, 1);
        }
        
        .music-icon {
            width: 20px;
            height: 20px;
            border-left: 8px solid #fff;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            margin-left: 3px;
        }
        
        .music-icon.paused::before, .music-icon.paused::after {
            content: '';
            position: absolute;
            width: 6px;
            height: 20px;
            background-color: #fff;
        }
        
        .music-icon.paused::before {
            left: 18px;
        }
        
        .music-icon.paused::after {
            right: 18px;
        }
        
        .music-icon.paused {
            border: none;
            margin: 0;
        }
        
        body {
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
            font-family: 'Arial', sans-serif;
        }
        
        .container {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        /* SVG å®¹å™¨æ ·å¼ */
        svg {
            position: relative;
            z-index: 2;
            filter: drop-shadow(0 0 20px rgba(255, 46, 99, 0.8));
        }
        
        /* å¿ƒå½¢è·¯å¾„æ ·å¼ */
        #heart-path {
            fill: none;
            stroke: #ff2e63;
            stroke-width: 4;
            stroke-linecap: round;
            stroke-linejoin: round;
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
        }
        
        #heart-fill {
            fill: rgba(255, 46, 99, 0.0);
        }
        
        /* æ–‡å­—æ ·å¼ */
        #name-text {
            font-size: 24px;
            font-weight: bold;
            fill: #fff;
            opacity: 0;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
            /* æ–‡å­—åœ¨å¯¹è¯æ¡†å¿ƒå½¢å®Œæˆåæ˜¾ç¤º */
        }
        
        /* æŒ‰é’®æ ·å¼ */
        #yes-button {
            position: relative;
            margin-top: 30px;
            padding: 10px 30px;
            background: transparent;
            border: 2px solid #ff2e63;
            color: #fff;
            font-size: 18px;
            cursor: pointer;
            border-radius: 30px;
            opacity: 0;
            /* æŒ‰é’®åœ¨å¯¹è¯æ¡†å¿ƒå½¢å®Œæˆåæ˜¾ç¤º */
            transition: all 0.3s ease;
            z-index: 10;
        }
        
        #yes-button:hover {
            background: rgba(255, 46, 99, 0.3);
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 46, 99, 0.8);
        }
        
        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            z-index: 100;
        }
        
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #ff2e63, #ff5f6d);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 0 30px rgba(255, 46, 99, 0.8);
            transform: scale(0.8);
            transition: transform 0.3s ease;
            max-width: 500px;
            width: 90%;
        }
        
        .modal.active .modal-content {
            transform: scale(1);
        }
        
        .modal-title {
            color: #fff;
            font-size: 24px;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
        }
        
        .modal-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .form-group {
            text-align: left;
        }
        
        .form-label {
            display: block;
            color: #fff;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-input {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            outline: none;
            background-color: rgba(255, 255, 255, 0.9);
            transition: background-color 0.3s ease;
        }
        
        .form-input:focus {
            background-color: #fff;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        .submit-button {
            background: #fff;
            color: #ff2e63;
            border: none;
            padding: 12px 20px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }
        
        .submit-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 255, 255, 0.3);
        }
        
        .modal-message {
            color: #666;
            text-align: center;
            margin-top: 15px;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        /* å¹¸è¿è½®ç›˜æ ·å¼ */
        .wheel-container {
            position: relative;
            width: 400px;
            height: 400px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .wheel {
            width: 380px;
            height: 380px;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            border: 8px solid #fff;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
            transition: transform 3s ease-in-out;
        }
        
        .wheel-section {
            position: absolute;
            width: 50%;
            height: 50%;
            transform-origin: bottom right;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 16px;
            color: white;
            writing-mode: vertical-rl;
            padding: 20px;
            overflow: hidden;
        }
        
        .wheel-section:nth-child(1) { background-color: #ff2e63; transform: rotate(0deg); }
        .wheel-section:nth-child(2) { background-color: #ffbc42; transform: rotate(60deg); }
        .wheel-section:nth-child(3) { background-color: #08d9d6; transform: rotate(120deg); }
        .wheel-section:nth-child(4) { background-color: #252a34; transform: rotate(180deg); }
        .wheel-section:nth-child(5) { background-color: #00adb5; transform: rotate(240deg); }
        .wheel-section:nth-child(6) { background-color: #f72585; transform: rotate(300deg); }
        
        .wheel-pointer {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            /* æ”¹è¿›çš„æŒ‡é’ˆæ ·å¼ - è°ƒæ•´ä½ç½®ä½¿å…¶ç²¾ç¡®æŒ‡å‘è½®ç›˜ä¸­å¿ƒ */
        }
        
        /* è½®ç›˜ç»“æœæ˜¾ç¤ºæ ·å¼ */
        .prize-result {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
            color: #ffffff !important;
            text-align: center;
            z-index: 100;
            position: relative;
            background: rgba(0, 0, 0, 0.3);
            padding: 10px 20px;
            border-radius: 20px;
        }
        
        .wheel-pointer::before {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-bottom: 30px solid #ff2e63;
            left: 50%;
            top: 0;
            transform: translateX(-50%);
        }
        
        .wheel-pointer::after {
            content: '';
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 15px;
            background-color: #fff;
            border-radius: 2px;
        }
        
        .spin-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: #fff;
            border: 4px solid #252a34;
            color: #252a34;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 5;
        }
        
        .spin-button:hover {
            background-color: #ff2e63;
            color: white;
            border-color: #ff2e63;
            transform: translate(-50%, -50%) scale(1.1);
        }
        
        .spin-button:disabled {
            background-color: #ccc;
            color: #666;
            border-color: #ccc;
            cursor: not-allowed;
            transform: translate(-50%, -50%) scale(1);
        }
        
        .prize-result {
            text-align: center;
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
            color: #ff2e63;
            min-height: 25px;
        }
        
        /* å“åº”å¼æ¨¡æ€æ¡† */
        @media (max-width: 480px) {
            .modal-content {
                padding: 20px;
            }
            
            .modal-title {
                font-size: 20px;
            }
            
            .form-input {
                font-size: 14px;
            }
        }
        
        /* èƒŒæ™¯å…‰æ•ˆ */
        .background-glow {
            position: absolute;
            background: radial-gradient(circle, rgba(255,46,99,0.3) 0%, rgba(255,46,99,0) 70%);
            border-radius: 50%;
            z-index: 1;
            opacity: 0;
            animation: glowAppear 1s ease-out forwards 3.5s;
        }
        
        .glow-1 {
            width: 500px;
            height: 500px;
        }
        
        .glow-2 {
            width: 700px;
            height: 700px;
            animation-delay: 3.8s;
        }
        
        /* æ˜Ÿå…‰æ•ˆæœ */
        .star {
            position: absolute;
            background-color: #fff;
            border-radius: 50%;
            opacity: 0;
            animation: twinkle var(--duration) ease-in-out infinite;
        }
        
        /* å¯¹è¯æ¡†æ°”æ³¡æ•ˆæœ */
        .bubble {
            position: absolute;
            padding: 8px 12px;
            border-radius: 18px;
            max-width: 120px;
            word-wrap: break-word;
            opacity: 0;
            transform: scale(0.8);
            transition: all 1s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            z-index: 2;
            font-size: 14px;
            line-height: 1.4;
            backdrop-filter: blur(2px);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            min-height: 36px;
        }
        
        /* ä¸°å¯Œçš„é¢œè‰²æ ·å¼ */
        .bubble.pink {
            background-color: #ff6b9d;
            color: white;
        }
        
        .bubble.purple {
            background-color: #9c27b0;
            color: white;
        }
        
        .bubble.yellow {
            background-color: #ffeb3b;
            color: #333;
        }
        
        .bubble.green {
            background-color: #4caf50;
            color: white;
        }
        
        .bubble.blue {
            background-color: #2196f3;
            color: white;
        }
        
        .bubble.orange {
            background-color: #ff9800;
            color: white;
        }
        
        .bubble.teal {
            background-color: #009688;
            color: white;
        }
        
        .bubble.red {
            background-color: #f44336;
            color: white;
        }
        
        .bubble.indigo {
            background-color: #3f51b5;
            color: white;
        }
        
        .bubble.lime {
            background-color: #cddc39;
            color: #333;
        }
        
        .bubble.appear {
            animation: bubbleAppear 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }
        
        .bubble.float {
            animation: bubbleFloat 4s ease-in-out infinite;
        }
        
        /* èƒŒæ™¯è£…é¥°å¿ƒå½¢ */
        .heart-decoration {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }
        
        .heart-decoration.appear {
            animation: heartDecorationAppear 1s ease-out forwards;
        }
        
        /* ä¸‹è½æ˜Ÿæ˜Ÿ */
        .falling-star {
            position: absolute;
            background-color: #fff;
            border-radius: 50%;
        }
        
        /* åŠ¨ç”»å®šä¹‰ */
        @keyframes drawHeart {
            0% {
                stroke-dashoffset: 1000;
            }
            100% {
                stroke-dashoffset: 0;
            }
        }
        
        @keyframes fillHeart {
            0% {
                fill: rgba(255, 46, 99, 0.0);
            }
            100% {
                fill: rgba(255, 46, 99, 0.5);
            }
        }
        
        @keyframes revealText {
            0% {
                opacity: 0;
                transform: scale(0.5);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes revealButton {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fallStar {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(200vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        @keyframes glowAppear {
            0% {
                opacity: 0;
                transform: scale(0.8);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes twinkle {
            0%, 100% {
                opacity: 0;
                transform: scale(0.5);
            }
            50% {
                opacity: 0.8;
                transform: scale(1);
            }
        }
        
        @keyframes bubbleAppear {
            0% {
                opacity: 0;
                transform: scale(0) translateY(20px);
            }
            70% {
                opacity: 1;
                transform: scale(1.1) translateY(0);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        @keyframes bubbleFloat {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
            }
            50% {
                transform: translateY(-8px) rotate(2deg);
            }
        }
        
        @keyframes heartDecorationAppear {
            0% {
                opacity: 0;
                transform: scale(0) rotate(-10deg);
            }
            70% {
                opacity: 0.3;
                transform: scale(1.05) rotate(0deg);
            }
            100% {
                opacity: 0.2;
                transform: scale(1) rotate(0deg);
            }
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            svg {
                width: 300px;
                height: 280px;
            }
            
            #name-text {
                font-size: 18px;
            }
            
            #yes-button {
                font-size: 16px;
                padding: 8px 20px;
            }
            
            .glow-1 {
                width: 350px;
                height: 350px;
            }
            
            .glow-2 {
                width: 500px;
                height: 500px;
            }
        }
        
        @media (max-width: 480px) {
            svg {
                width: 250px;
                height: 230px;
            }
            
            #name-text {
                font-size: 16px;
            }
            
            #yes-button {
            font-size: 14px;
            padding: 6px 16px;
        }
        
        .glow-1 {
            width: 280px;
            height: 280px;
        }
        
        .glow-2 {
            width: 400px;
            height: 400px;
        }
        
        /* è®¡æ—¶å·¥å…·æ ·å¼ */
        .countdown-container {
            position: relative;
            margin-top: 20px;
            margin-bottom: 20px;
            padding: 20px 30px;
            background: rgba(255, 46, 99, 0.8);
            border: 3px solid #ff2e63;
            border-radius: 30px;
            color: #fff;
            font-size: 20px;
            text-align: center;
            opacity: 1;
            z-index: 9999; /* æé«˜å±‚çº§ç¡®ä¿åœ¨é¡¶éƒ¨ */
            box-shadow: 0 0 20px rgba(255, 46, 99, 0.8);
            min-width: 300px;
            display: block; /* ç¡®ä¿æ˜¯å—å…ƒç´  */
        }
        
        .countdown-days {
            font-size: 32px;
            font-weight: bold;
            color: #ffbc42;
            text-shadow: 0 0 15px rgba(255, 188, 66, 0.8);
            background: rgba(255, 188, 66, 0.2);
            padding: 5px 15px;
            border-radius: 20px;
        }
        
        @media (max-width: 768px) {
            .countdown-container {
                font-size: 16px;
                padding: 12px 20px;
            }
            
            .countdown-days {
                font-size: 24px;
            }
        }
        
        @media (max-width: 480px) {
            .countdown-container {
                font-size: 14px;
                padding: 10px 15px;
            }
            
            .countdown-days {
                font-size: 20px;
            }
        }
        

        

    </style>
</head>
<body>
    <!-- è®¡æ—¶å·¥å…· -->
    
    <div class="container">
        
        <!-- èƒŒæ™¯å…‰æ•ˆ -->
        <div class="background-glow glow-1"></div>
        <div class="background-glow glow-2"></div>
        
        <!-- æ–‡å­— -->
        <svg width="600" height="400" viewBox="0 0 600 400">
            <!-- æ¢å¤åŸå§‹å¿ƒå½¢è·¯å¾„ - å¢å¤§å°ºå¯¸ä»¥åŒ…è£¹æ–‡å­— -->
            <path id="heart-path" d="M300,80 C380,0 520,140 300,280 C80,140 220,0 300,80 Z" />
            <path id="heart-fill" d="M300,80 C380,0 520,140 300,280 C80,140 220,0 300,80 Z" />
            <text id="name-text" x="300" y="180" text-anchor="middle" dominant-baseline="middle" font-size="28">é˜¿é›¯å¯ä»¥åšé˜¿å¸¸çš„å¹¸è¿æ˜Ÿå˜›</text>
        </svg>
        
        <!-- å¯ä»¥æŒ‰é’® -->
        <button id="yes-button">å¯ä»¥</button>
    </div>
    
    <!-- éŸ³ä¹æ§åˆ¶æŒ‰é’® -->
    <div class="music-control" id="musicControl">
        <div class="music-icon" id="musicIcon"></div>
    </div>
    
    <!-- æ¨¡æ€æ¡† -->
    <div id="modal" class="modal">
        <div class="modal-content">
                    <h2 class="modal-title">é˜¿é›¯ä¸é˜¿å¸¸çš„ç•™è¨€æ¿</h2>
                    
                    <!-- å¹¸è¿è½®ç›˜ -->
                    <div class="wheel-container">
                        <div id="wheel" class="wheel">
                            <div class="wheel-section" style="--index:0">å¥¶èŒ¶</div>
                            <div class="wheel-section" style="--index:1">å°è›‹ç³•</div>
                            <div class="wheel-section" style="--index:2">é¡¹é“¾</div>
                            <div class="wheel-section" style="--index:3">ç»™é˜¿å¸¸è¯´æ—©å®‰</div>
                            <div class="wheel-section" style="--index:4">é›¶é£Ÿç¤¼åŒ…</div>
                            <div class="wheel-section" style="--index:5">èŠ±</div>
                        </div>
                        <!-- æŒ‡é’ˆå·²ç§»é™¤ -->
                        <button id="spin-button" class="spin-button">å¹¸è¿è½¬ç›˜</button>
                        <p id="prize-result" class="prize-result"></p>
                    </div>
                    
                    <form id="modal-form" class="modal-form">
                        <div class="form-group">
                            <label for="address" class="form-label">åœ°å€</label>
                            <input type="text" id="address" name="address" placeholder="è¯·è¾“å…¥æ‚¨çš„åœ°å€" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label for="phone" class="form-label">æ‰‹æœºå·ç </label>
                            <input type="tel" id="phone" name="phone" placeholder="è¯·è¾“å…¥æ‚¨çš„æ‰‹æœºå·" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label for="milk-tea" class="form-label">ä»Šå¤©æƒ³å¯¹é˜¿å¸¸è¯´çš„è¯</label>
                            <input type="text" id="milk-tea" name="milk-tea" placeholder="è¯·è¾“å…¥æ‚¨æƒ³å¯¹é˜¿å¸¸è¯´çš„è¯" class="form-input" required>
                        </div>
                        <input type="hidden" id="prize" name="prize" value="">
                        <button type="submit" class="submit-button">ç¡®å®š</button>
                    </form>
                    <p class="modal-message">å¡«å†™åœ°å€å’Œæƒ³å¯¹é˜¿å¸¸è¯´çš„è¯ï¼Œå¯ä»¥è·å¾—å¹¸è¿ç¤¼åŒ…å“¦~</p>
                </div>
    </div>
    

    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ä½¿ç”¨æ”¹è¿›çš„ç®—æ³•ç”Ÿæˆå¿ƒå½¢æ›²çº¿ç‚¹
            function generateHeartPoints(size = 100, centerX = 0, centerY = 0, points = 100) {
                const heartPoints = [];
                
                for (let i = 0; i <= points; i++) {
                    const t = (i / points) * Math.PI * 2;
                    // ä½¿ç”¨æ”¹è¿›çš„å¿ƒå½¢æ›²çº¿å…¬å¼
                    const x = 16 * Math.pow(Math.sin(t), 3);
                    const y = 13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t);
                    
                    // è°ƒæ•´åæ ‡å¹¶æ·»åŠ åˆ°æ•°ç»„
                    heartPoints.push({
                        x: centerX + x * (size / 16),
                        y: centerY - y * (size / 16) // æ³¨æ„è¿™é‡Œæ˜¯å‡å·ï¼Œå› ä¸ºSVGåæ ‡æ˜¯Yè½´å‘ä¸‹
                    });
                }
                
                return heartPoints;
            }
            
            // ç”Ÿæˆå±å¹•å¤–éƒ¨çš„éšæœºèµ·å§‹ä½ç½®
            function getRandomStartPosition() {
                const edge = Math.floor(Math.random() * 4); // 0: ä¸Š, 1: å³, 2: ä¸‹, 3: å·¦
                const offset = 100; // å±å¹•å¤–åç§»é‡
                const x = Math.random() * window.innerWidth;
                const y = Math.random() * window.innerHeight;
                
                switch(edge) {
                    case 0: // ä¸Š
                        return { x, y: -offset };
                    case 1: // å³
                        return { x: window.innerWidth + offset, y };
                    case 2: // ä¸‹
                        return { x, y: window.innerHeight + offset };
                    case 3: // å·¦
                        return { x: -offset, y };
                }
            }
            
            // åˆ›å»ºæŒ‰é’®æ‚¬åœæ—¶çš„é—ªå…‰æ•ˆæœ
            function createSparkles(element) {
                const rect = element.getBoundingClientRect();
                const centerX = rect.left + rect.width / 2;
                const centerY = rect.top + rect.height / 2;
                const sparkleCount = 20;
                
                for (let i = 0; i < sparkleCount; i++) {
                    setTimeout(() => {
                        const sparkle = document.createElement('div');
                        sparkle.classList.add('sparkle');
                        
                        // éšæœºå¤§å°
                        const size = 2 + Math.random() * 4;
                        sparkle.style.width = `${size}px`;
                        sparkle.style.height = `${size}px`;
                        
                        // éšæœºé¢œè‰²
                        const colors = ['#fff', '#ffbc42', '#ff2e63', '#08d9d6'];
                        sparkle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                        
                        // èµ·å§‹ä½ç½®åœ¨æŒ‰é’®ä¸­å¿ƒ
                        sparkle.style.left = `${centerX}px`;
                        sparkle.style.top = `${centerY}px`;
                        
                        document.body.appendChild(sparkle);
                        
                        // éšæœºæ–¹å‘å’Œè·ç¦»
                        const angle = Math.random() * Math.PI * 2;
                        const distance = 20 + Math.random() * 30;
                        const endX = centerX + Math.cos(angle) * distance;
                        const endY = centerY + Math.sin(angle) * distance;
                        
                        // åŠ¨ç”»
                        setTimeout(() => {
                            sparkle.style.transition = 'all 0.8s ease-out';
                            sparkle.style.left = `${endX}px`;
                            sparkle.style.top = `${endY}px`;
                            sparkle.style.opacity = '0';
                            sparkle.style.transform = 'scale(0)';
                            
                            // ç§»é™¤
                            setTimeout(() => {
                                if (sparkle.parentNode) {
                                    sparkle.parentNode.removeChild(sparkle);
                                }
                            }, 800);
                        }, 50);
                    }, i * 50);
                }
            }
            
            // åˆ›å»ºå¿ƒå½¢çˆ†ç‚¸æ•ˆæœ
            function createHeartBurst(element) {
                const rect = element.getBoundingClientRect();
                const centerX = rect.left + rect.width / 2;
                const centerY = rect.top + rect.height / 2;
                const particleCount = 30;
                const heartEmojis = ['â¤ï¸', 'ğŸ’•', 'ğŸ’–', 'ğŸ’—', 'ğŸ’“', 'ğŸ’˜'];
                
                for (let i = 0; i < particleCount; i++) {
                    const particle = document.createElement('div');
                    particle.classList.add('heart-particle');
                    particle.textContent = heartEmojis[Math.floor(Math.random() * heartEmojis.length)];
                    
                    // éšæœºå¤§å°
                    const size = 12 + Math.random() * 12;
                    particle.style.fontSize = `${size}px`;
                    
                    // èµ·å§‹ä½ç½®
                    particle.style.left = `${centerX}px`;
                    particle.style.top = `${centerY}px`;
                    particle.style.transform = 'translate(-50%, -50%) scale(0)';
                    
                    document.body.appendChild(particle);
                    
                    // éšæœºæ–¹å‘å’Œè·ç¦»
                    const angle = Math.random() * Math.PI * 2;
                    const distance = 40 + Math.random() * 60;
                    const endX = centerX + Math.cos(angle) * distance;
                    const endY = centerY + Math.sin(angle) * distance;
                    
                    // éšæœºæ—‹è½¬
                    const rotation = Math.random() * 360;
                    
                    // åŠ¨ç”»
                    setTimeout(() => {
                        particle.style.transition = 'all 1.2s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
                        particle.style.left = `${endX}px`;
                        particle.style.top = `${endY}px`;
                        particle.style.transform = `translate(-50%, -50%) rotate(${rotation}deg) scale(1)`;
                        
                        // ä¸Šå‡å¹¶æ¶ˆå¤±
                        setTimeout(() => {
                            particle.style.transition = 'all 1s ease-out';
                            particle.style.top = `${endY - 50}px`;
                            particle.style.opacity = '0';
                            particle.style.transform = `translate(-50%, -50%) rotate(${rotation + 180}deg) scale(0.5)`;
                            
                            // ç§»é™¤
                            setTimeout(() => {
                                if (particle.parentNode) {
                                    particle.parentNode.removeChild(particle);
                                }
                            }, 1000);
                        }, 600);
                    }, 50);
                }
            }
            
            // å¯¹è¯å†…å®¹æ•°æ®ç»“æ„
            const conversationThemes = {
                firstMeeting: [
                    'ç¬¬ä¸€çœ¼è§åˆ°ä½ ï¼Œå°±è§‰å¾—ä½ ç‰¹åˆ«',
                    'é‚£å¤©é˜³å…‰å¾ˆå¥½ï¼Œè€Œä½ æ¯”é˜³å…‰æ›´è€€çœ¼',
                    'ä½ ä¸ç»æ„çš„ä¸€ä¸ªå¾®ç¬‘ï¼Œæˆ‘è®°äº†å¾ˆä¹…',
                    'è®¤è¯†ä½ ä¹‹åï¼Œä¸–ç•Œå˜å¾—ä¸ä¸€æ ·äº†',
                    'ç¬¬ä¸€æ¬¡å’Œä½ è¯´è¯ï¼Œæˆ‘ç´§å¼ å¾—å¿˜è®°äº†æƒ³è¯´ä»€ä¹ˆ'
                ],
                deepFeelings: [
                    'ä½ æ˜¯æˆ‘ç”Ÿå‘½ä¸­æœ€ç¾çš„é£æ™¯',
                    'æƒ³æŠŠä¸–ç•Œä¸Šæœ€å¥½çš„éƒ½ç»™ä½ ',
                    'æœ‰ä½ åœ¨ï¼Œå†éš¾çš„æ—¥å­ä¹Ÿå˜å¾—å®¹æ˜“',
                    'ä½ çš„å­˜åœ¨è®©æˆ‘çš„ç”Ÿæ´»å……æ»¡æ„ä¹‰',
                    'æ¯ä¸€ä¸ªå¹³å‡¡çš„æ—¥å­ï¼Œå› ä¸ºæœ‰ä½ è€Œä¸å¹³å‡¡'
                ],
                sweetMemories: [
                    'è®°å¾—é‚£å¤©æˆ‘ä»¬ä¸€èµ·çœ‹çš„æ—¥è½å—ï¼Ÿ',
                    'ç¬¬ä¸€æ¬¡ç‰µæ‰‹çš„æ„Ÿè§‰æˆ‘æ°¸è¿œä¸ä¼šå¿˜è®°',
                    'é‚£æ¬¡æ—…è¡Œæ˜¯æˆ‘æœ€ç¾å¥½çš„å›å¿†',
                    'é‚£å¤©ä½ ç¬‘èµ·æ¥ï¼Œæ•´ä¸ªä¸–ç•Œéƒ½äº®äº†',
                    'ä½ ä¸ºæˆ‘åšçš„ä¸€åˆ‡ï¼Œæˆ‘éƒ½çè—åœ¨å¿ƒé‡Œ'
                ],
                promises: [
                    'æˆ‘ä¼šä¸€ç›´é™ªç€ä½ ï¼Œä¸ç®¡å‘ç”Ÿä»€ä¹ˆ',
                    'æˆ‘ä¼šç”¨ä¸€ç”Ÿçš„æ—¶é—´è¯æ˜æˆ‘çš„çˆ±',
                    'æ— è®ºé¡ºå¢ƒè¿˜æ˜¯é€†å¢ƒï¼Œæˆ‘éƒ½åœ¨ä½ èº«è¾¹',
                    'æˆ‘æƒ³å’Œä½ ä¸€èµ·çœ‹æ— æ•°æ¬¡æ—¥å‡ºæ—¥è½',
                    'ä½™ç”Ÿè¯·å¤šæŒ‡æ•™',
                    'æ‰§å­ä¹‹æ‰‹ï¼Œä¸å­å•è€'
                ],
                dailyAffection: [
                    'ä»Šå¤©æœ‰æ²¡æœ‰æƒ³æˆ‘å‘€ï¼Ÿ',
                    'è®°å¾—æŒ‰æ—¶åƒé¥­ï¼Œç…§é¡¾å¥½è‡ªå·±',
                    'ä»Šå¤©å¤©æ°”å¾ˆå¥½ï¼Œå°±åƒè§åˆ°ä½ ä¸€æ ·å¼€å¿ƒ',
                    'å·¥ä½œå†å¿™ä¹Ÿè¦æ³¨æ„ä¼‘æ¯å“¦',
                    'æ™šä¸Šä¸€èµ·çœ‹æ˜Ÿæ˜Ÿå§ï¼Ÿ',
                    'æƒ³å¬ä½ çš„å£°éŸ³äº†',
                    'ä»Šå¤©åˆæƒ³äº†ä½ ä¸€æ•´å¤©'
                ],
                compliments: [
                    'ä½ ç¬‘èµ·æ¥çœŸå¥½çœ‹',
                    'ä½ çš„çœ¼ç›é‡Œæœ‰æ˜Ÿæ˜Ÿ',
                    'ä½ ç©¿è¿™ä»¶è¡£æœçœŸå¥½çœ‹',
                    'ä½ åšçš„èœæ˜¯ä¸–ç•Œä¸Šæœ€ç¾å‘³çš„',
                    'ä½ çœŸèªæ˜ï¼Œä»€ä¹ˆéƒ½éš¾ä¸å€’ä½ ',
                    'ä½ è®¤çœŸçš„æ ·å­æœ€è¿·äºº',
                    'å’Œä½ åœ¨ä¸€èµ·çš„æ—¶å…‰æ€»æ˜¯é‚£ä¹ˆç¾å¥½'
                ],
                gratitude: [
                    'è°¢è°¢ä½ ä¸€ç›´ä»¥æ¥çš„é™ªä¼´',
                    'æœ‰ä½ çœŸå¥½ï¼Œæˆ‘å¾ˆå¹¸è¿',
                    'æ„Ÿè°¢ä½ å‡ºç°åœ¨æˆ‘çš„ç”Ÿå‘½é‡Œ',
                    'é‡åˆ°ä½ æ˜¯æˆ‘æœ€å¤§çš„ç¦æ°”',
                    'è°¢è°¢ä½ çˆ±æˆ‘',
                    'é‡è§ä½ ï¼Œæ˜¯æˆ‘è¿™è¾ˆå­æœ€å¹¸ç¦çš„äº‹'
                ],
                specialMoments: [
                    'å’Œä½ åœ¨ä¸€èµ·çš„æ¯ä¸€å¤©éƒ½å€¼å¾—çºªå¿µ',
                    'æœ‰ä½ çš„å¤œæ™šï¼Œè¿æ˜Ÿæ˜Ÿéƒ½å˜å¾—æ›´äº®äº†',
                    'æˆ‘å–œæ¬¢çœ‹ä½ ä¸“æ³¨åšä¸€ä»¶äº‹çš„æ ·å­',
                    'ä½ æ˜¯æˆ‘æ¯å¤©é†’æ¥æœ€æƒ³è§åˆ°çš„äºº',
                    'å’Œä½ èŠå¤©ï¼Œæ—¶é—´æ€»æ˜¯è¿‡å¾—ç‰¹åˆ«å¿«'
                ],
                emojis: ['â¤ï¸', 'ğŸ’•', 'ğŸ’–', 'ğŸ’—', 'ğŸ’“', 'ğŸ’˜', 'ğŸ’', 'ğŸ¥°', 'ğŸ˜', 'ğŸ˜˜']
            };
            
            // è·å–éšæœºå¯¹è¯å†…å®¹
            function getRandomMessage() {
                // éšæœºé€‰æ‹©ä¸€ä¸ªä¸»é¢˜ç±»åˆ«
                const themeKeys = Object.keys(conversationThemes);
                const randomTheme = themeKeys[Math.floor(Math.random() * themeKeys.length)];
                
                // ä»è¯¥ä¸»é¢˜ä¸­é€‰æ‹©ä¸€æ¡æ¶ˆæ¯
                const themeMessages = conversationThemes[randomTheme];
                return themeMessages[Math.floor(Math.random() * themeMessages.length)];
            }
            
            // éšæœºé€‰æ‹©æ°”æ³¡ç±»å‹
            function getRandomBubbleType() {
                const types = ['pink', 'purple', 'yellow', 'green', 'blue', 'orange', 'teal', 'red', 'indigo', 'lime'];
                return types[Math.floor(Math.random() * types.length)];
            }
            
            // åˆ›å»ºèƒŒæ™¯è£…é¥°å¿ƒå½¢
            function createBackgroundDecorations() {
                const container = document.querySelector('.container');
                const decorationCount = 15;
                
                for (let i = 0; i < decorationCount; i++) {
                    const heart = document.createElement('div');
                    heart.classList.add('heart-decoration');
                    
                    // éšæœºå¤§å°
                    const size = 20 + Math.random() * 80;
                    heart.style.width = `${size}px`;
                    heart.style.height = `${size}px`;
                    
                    // éšæœºä½ç½®ï¼ˆç¡®ä¿åœ¨è§†å£èŒƒå›´å†…ï¼‰
                    const x = Math.random() * (window.innerWidth - size);
                    const y = Math.random() * (window.innerHeight - size);
                    heart.style.left = `${x}px`;
                    heart.style.top = `${y}px`;
                    
                    // éšæœºæ—‹è½¬è§’åº¦
                    const rotation = Math.random() * 360;
                    heart.style.transform = `rotate(${rotation}deg)`;
                    
                    // åˆ›å»ºSVGå¿ƒå½¢
                    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                    svg.setAttribute('width', size);
                    svg.setAttribute('height', size);
                    svg.setAttribute('viewBox', '0 0 100 100');
                    
                    const points = generateHeartPoints(40, 50, 50, 50);
                    let pathData = `M${points[0].x},${points[0].y}`;
                    
                    for (let j = 1; j < points.length; j++) {
                        pathData += ` L${points[j].x},${points[j].y}`;
                    }
                    
                    pathData += ' Z';
                    
                    const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                    path.setAttribute('d', pathData);
                    path.setAttribute('fill', 'currentColor');
                    
                    // éšæœºé¢œè‰²
                    const colors = ['#ff2e63', '#ffbc42', '#08d9d6', '#fff'];
                    const color = colors[Math.floor(Math.random() * colors.length)];
                    heart.style.color = color;
                    
                    svg.appendChild(path);
                    heart.appendChild(svg);
                    
                    document.body.appendChild(heart);
                    
                    // æ·»åŠ å‡ºç°åŠ¨ç”»
                    setTimeout(() => {
                        heart.classList.add('appear');
                    }, i * 200 + Math.random() * 1000);
                }
            }
            
            // åˆ›å»ºéšæœºæ˜Ÿå…‰æ•ˆæœ
            function createStars() {
                const container = document.querySelector('.container');
                const starCount = 50;
                
                for (let i = 0; i < starCount; i++) {
                    const star = document.createElement('div');
                    star.classList.add('star');
                    
                    // éšæœºä½ç½®
                    const x = Math.random() * 100;
                    const y = Math.random() * 100;
                    star.style.left = `${x}vw`;
                    star.style.top = `${y}vh`;
                    
                    // éšæœºåŠ¨ç”»æŒç»­æ—¶é—´
                    const duration = 2 + Math.random() * 3;
                    star.style.setProperty('--duration', `${duration}s`);
                    
                    // éšæœºå¤§å°
                    const size = 1 + Math.random() * 3;
                    star.style.width = `${size}px`;
                    star.style.height = `${size}px`;
                    
                    // éšæœºå»¶è¿Ÿ
                    star.style.animationDelay = `${Math.random() * 5}s`;
                    
                    document.body.appendChild(star);
                }
            }
            
            // åˆ›å»ºä¸´æ—¶æ°”æ³¡ï¼ˆæœ‰è¿›æœ‰å‡ºæ•ˆæœï¼‰
            function createTemporaryBubbles() {
                const tempBubbleCount = 150;
                
                for (let i = 0; i < tempBubbleCount; i++) {
                    setTimeout(() => {
                        const bubble = document.createElement('div');
                        bubble.classList.add('bubble');
                        bubble.classList.add(getRandomBubbleType());
                        bubble.textContent = getRandomMessage();
                        
                        // éšæœºå¤§å°
                        const bubbleSize = 40 + Math.random() * 30;
                        bubble.style.minWidth = `${bubbleSize}px`;
                        bubble.style.maxWidth = `${bubbleSize + 30}px`;
                        
                        // éšæœºä½ç½®
                        const startPos = getRandomStartPosition();
                        bubble.style.left = `${startPos.x}px`;
                        bubble.style.top = `${startPos.y}px`;
                        bubble.style.opacity = '0';
                        
                        document.body.appendChild(bubble);
                        
                        // è§¦å‘é‡æ’
                        void bubble.offsetWidth;
                        
                        // å‡ºç°åŠ¨ç”»
                        setTimeout(() => {
                            bubble.style.opacity = '1';
                            bubble.style.transform = 'scale(1)';
                            
                            // éšæœºç›®æ ‡ä½ç½®
                            const targetX = Math.random() * window.innerWidth;
                            const targetY = Math.random() * window.innerHeight;
                            bubble.style.left = `${targetX}px`;
                            bubble.style.top = `${targetY}px`;
                            
                            // ä¸€æ®µæ—¶é—´åæ¶ˆå¤±
                            setTimeout(() => {
                                bubble.style.opacity = '0';
                                bubble.style.transform = 'scale(0)';
                                
                                // ç§»é™¤æ°”æ³¡
                                setTimeout(() => {
                                    if (bubble.parentNode) {
                                        bubble.parentNode.removeChild(bubble);
                                    }
                                }, 800);
                            }, 2000 + Math.random() * 3000);
                        }, 50);
                    }, i * 50);
                }
            }
            
            // åˆ›å»ºæ»¡å±æ°”æ³¡æ•ˆæœï¼Œæµ®ç°åå®šæ ¼2ç§’æ¶ˆå¤±
            function createBubbles() {
                // å…ˆåˆ›å»ºä¸´æ—¶æ°”æ³¡ï¼ˆæœ‰è¿›æœ‰å‡ºæ•ˆæœï¼‰
                createTemporaryBubbles();
                
                const bubbleCount = 350; // æ°”æ³¡æ•°é‡
                const allBubbles = []; // ä¿å­˜æ‰€æœ‰æ°”æ³¡å¼•ç”¨
                
                // åˆ›å»ºæ»¡å±éšæœºä½ç½®çš„æ°”æ³¡
                for (let i = 0; i < bubbleCount; i++) {
                    setTimeout(() => {
                        const bubble = document.createElement('div');
                        bubble.classList.add('bubble');
                        bubble.classList.add(getRandomBubbleType());
                        bubble.textContent = getRandomMessage();
                        
                        // è®¾ç½®æ°”æ³¡å¤§å°
                        const bubbleSize = 70 + Math.random() * 40;
                        bubble.style.minWidth = `${bubbleSize}px`;
                        bubble.style.maxWidth = `${bubbleSize + 50}px`;
                        
                        // è·å–å±å¹•å¤–çš„éšæœºèµ·å§‹ä½ç½®
                        const startPos = getRandomStartPosition();
                        
                        // è®¾ç½®åˆå§‹ä½ç½®ï¼ˆå±å¹•å¤–ï¼‰
                        bubble.style.left = `${startPos.x}px`;
                        bubble.style.top = `${startPos.y}px`;
                        bubble.style.opacity = '0';
                        
                        document.body.appendChild(bubble);
                        allBubbles.push(bubble); // ä¿å­˜æ°”æ³¡å¼•ç”¨
                        
                        // è§¦å‘é‡æ’ï¼Œç¡®ä¿åŠ¨ç”»æ­£å¸¸å·¥ä½œ
                        void bubble.offsetWidth;
                        
                        // è®¾ç½®ç›®æ ‡ä½ç½®ï¼ˆå±å¹•å†…éšæœºä½ç½®ï¼‰å¹¶æ˜¾ç¤ºæ°”æ³¡
                        setTimeout(() => {
                            // éšæœºç›®æ ‡ä½ç½®ï¼ˆå±å¹•å†…ï¼‰
                            const targetX = Math.random() * (window.innerWidth - bubbleSize - 50);
                            const targetY = Math.random() * (window.innerHeight - 100);
                            
                            bubble.style.left = `${targetX}px`;
                            bubble.style.top = `${targetY}px`;
                            bubble.style.opacity = '1';
                            bubble.style.transform = 'scale(1)';
                            
                            // å‡ºç°åæ·»åŠ æµ®åŠ¨æ•ˆæœ
                            setTimeout(() => {
                                bubble.classList.add('float');
                                bubble.style.animationDelay = `${Math.random() * 2}s`;
                                bubble.style.animationDuration = `${3 + Math.random() * 3}s`;
                            }, 800);
                        }, 50);
                    }, i * 40 + 3000); // å»¶è¿Ÿåˆ›å»ºæ°”æ³¡ï¼Œè®©ä¸´æ—¶æ°”æ³¡å…ˆå‡ºç°
                }
                
                // è®¡ç®—æ‰€æœ‰æ°”æ³¡å®Œæˆæ‰€éœ€æ—¶é—´
                const allBubblesCompleteTime = bubbleCount * 40 + 3000 + 1000;
                
                // æ‰€æœ‰æ°”æ³¡å®Œæˆåå®šæ ¼2ç§’ï¼Œç„¶åæ¶ˆå¤±
                setTimeout(() => {
                    // æ‰€æœ‰æ°”æ³¡å¼€å§‹æ¶ˆå¤±
                    allBubbles.forEach((bubble, index) => {
                        setTimeout(() => {
                            bubble.style.opacity = '0';
                            bubble.style.transform = 'scale(0)';
                            
                            // ç§»é™¤æ°”æ³¡
                            setTimeout(() => {
                                if (bubble.parentNode) {
                                    bubble.parentNode.removeChild(bubble);
                                }
                            }, 800);
                        }, index * 20); // ä¾æ¬¡æ¶ˆå¤±ï¼Œå½¢æˆæµåŠ¨æ•ˆæœ
                    });
                    
                    // æ°”æ³¡æ¶ˆå¤±åï¼Œæ˜¾ç¤ºåŸå§‹å¿ƒå½¢
                    setTimeout(() => {
                        // æ¢å¤åŸå§‹å¿ƒå½¢è·¯å¾„
                        const heartPath = document.getElementById('heart-path');
                        if (heartPath) {
                            heartPath.style.animation = 'drawHeart 3s ease-in-out forwards';
                        }
                        
                        // å¿ƒå½¢å¡«å……åŠ¨ç”»
                        const heartFill = document.getElementById('heart-fill');
                        if (heartFill) {
                            setTimeout(() => {
                                heartFill.style.animation = 'fillHeart 2s ease-out forwards';
                            }, 2500);
                        }
                        
                        // æ˜¾ç¤ºæ–‡å­—å’ŒæŒ‰é’®
                        setTimeout(() => {
                            const nameText = document.getElementById('name-text');
                            const yesButton = document.getElementById('yes-button');
                            
                            // ä½¿ç”¨åŠ¨ç”»æ˜¾ç¤ºæ–‡å­—ï¼ˆæ›´æµªæ¼«çš„æ•ˆæœï¼‰
                            nameText.style.animation = 'revealText 1.5s ease-out forwards';
                            
                            // æ–‡å­—æ˜¾ç¤ºåæ˜¾ç¤ºæŒ‰é’®
                            setTimeout(() => {
                                yesButton.style.animation = 'revealButton 1.5s ease-out forwards';
                            }, 800);
                        }, 3500); // å¿ƒå½¢ç»˜åˆ¶å®Œæˆåæ˜¾ç¤ºæ–‡å­—å’ŒæŒ‰é’®
                    }, bubbleCount * 20 + 1000);
                }, allBubblesCompleteTime + 2000); // åœç•™2ç§’åå¼€å§‹æ¶ˆå¤±
            }
            
            // åˆå§‹åŒ–èƒŒæ™¯æ•ˆæœ
            createStars();
            createBackgroundDecorations();
            
            // å»¶è¿Ÿåˆ›å»ºæ°”æ³¡ï¼Œè®©é¡µé¢å…ˆåŠ è½½å®Œæˆ
            setTimeout(() => {
                createBubbles();
            }, 2000);
            
            // å®ç°ç‚¹å‡»"å¯ä»¥"æŒ‰é’®åçš„æµªæ¼«æ•ˆæœ
            const yesButton = document.getElementById('yes-button');
            
            // æ·»åŠ æ‚¬åœæ•ˆæœ
            yesButton.addEventListener('mouseenter', function() {
                createSparkles(this);
            });
            
            // ä¼˜åŒ–æŒ‰é’®ç‚¹å‡»æ•ˆæœ
            yesButton.addEventListener('click', function() {
                // åˆ›å»ºå¿ƒå½¢çˆ†ç‚¸æ•ˆæœ
                createHeartBurst(this);
                
                // ç§»é™¤æ‰€æœ‰ç°æœ‰çš„æ˜Ÿæ˜Ÿ
                const existingStars = document.querySelectorAll('.falling-star');
                existingStars.forEach(star => star.remove());
                
                // ç”Ÿæˆå¤§é‡æ˜Ÿæ˜Ÿ
                for (let i = 0; i < 300; i++) {
                    createFallingStar();
                }
                
                // æ˜¾ç¤ºæ¨¡æ€æ¡†
                setTimeout(() => {
                    const modal = document.getElementById('modal');
                    modal.classList.add('active');
                }, 1000);
                
                // æŒ‰é’®ç¦ç”¨
                this.disabled = true;
                this.style.opacity = '0.6';
                this.style.cursor = 'not-allowed';
            });
            
            // åˆ›å»ºä¸‹è½çš„æ˜Ÿæ˜Ÿ
            function createFallingStar() {
                const star = document.createElement('div');
                star.classList.add('falling-star');
                
                // éšæœºä½ç½®
                const x = Math.random() * 100;
                star.style.left = `${x}vw`;
                
                // éšæœºåŠ¨ç”»æŒç»­æ—¶é—´
                const duration = 2 + Math.random() * 3;
                star.style.animation = `fallStar ${duration}s linear forwards`;
                
                // éšæœºå»¶è¿Ÿ
                star.style.animationDelay = `${Math.random() * 2}s`;
                
                // éšæœºå¤§å°
                const size = 1 + Math.random() * 3;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                
                // éšæœºé¢œè‰²
                const colors = ['#fff', '#ff2e63', '#08d9d6', '#ffbc42'];
                const color = colors[Math.floor(Math.random() * colors.length)];
                star.style.backgroundColor = color;
                
                // éšæœºé€æ˜åº¦
                star.style.opacity = 0.3 + Math.random() * 0.7;
                
                // éšæœºæ¨¡ç³Šæ•ˆæœ
                star.style.filter = `blur(${Math.random() * 1}px)`;
                
                document.body.appendChild(star);
                
                // åŠ¨ç”»ç»“æŸåç§»é™¤
                setTimeout(() => {
                    star.remove();
                }, (duration + 2) * 1000);
            }
            
            // å·²åˆ é™¤çŸ­ä¿¡å‘é€åŠŸèƒ½ï¼Œæ‰€æœ‰ä¿¡æ¯é€šè¿‡é‚®ä»¶å‘é€
            
            // é‚®ä»¶å‘é€å‡½æ•° - ä½¿ç”¨åç«¯APIè¿›è¡ŒçœŸå®é‚®ä»¶å‘é€
            async function sendEmail(userInfo) {
                const { address, phone, message, prize } = userInfo;
                const recipientEmail = '1972635933@qq.com'; // æ›¿æ¢ä¸ºæ‚¨çš„QQé‚®ç®±åœ°å€
                
                // æ„å»ºé‚®ä»¶å†…å®¹
                const emailSubject = `æ–°çš„çˆ±çš„å‘Šç™½ - ${new Date().toLocaleString()}`;
                const emailBody = `æ”¶åˆ°æ–°çš„çˆ±çš„å‘Šç™½ï¼\n\n` +
                                 `åœ°å€: ${address}\n` +
                                 `æ‰‹æœºå·: ${phone}\n` +
                                 `æƒ³å¯¹é˜¿å¸¸è¯´çš„è¯: ${message}\n` +
                                 `å¹¸è¿å¥–å“: ${prize}\n\n` +
                                 `å‘Šç™½æ—¶é—´: ${new Date().toLocaleString()}`;
                
                try {
                    // è®°å½•é‚®ä»¶å‘é€ä¿¡æ¯
                    console.log('é‚®ä»¶ä¿¡æ¯:', {
                        to: recipientEmail,
                        subject: emailSubject,
                        body: emailBody
                    });
                    
                    // è°ƒç”¨åç«¯APIå‘é€é‚®ä»¶
                    console.log('è°ƒç”¨åç«¯é‚®ä»¶å‘é€API...');
                    const response = await fetch('http://localhost:3000/send-email', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            to: recipientEmail,
                            subject: emailSubject,
                            body: emailBody
                        }),
                        // 5ç§’è¶…æ—¶
                        signal: AbortSignal.timeout(5000)
                    });
                      
                    if (!response.ok) {
                        throw new Error('APIå“åº”å¤±è´¥: ' + response.status);
                    }
                      
                    const result = await response.json();
                    console.log('é‚®ä»¶å‘é€ç»“æœ:', result);
                    return result;
                } catch (error) {
                    console.error('é‚®ä»¶å‘é€å¤±è´¥:', error);
                    return {
                        success: false,
                        message: 'é‚®ä»¶å‘é€å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•',
                        error: error.message
                    };
                }
            }
            
            // å¹¸è¿è½®ç›˜åŠŸèƒ½
            const wheel = document.getElementById('wheel');
            const spinButton = document.getElementById('spin-button');
            const prizeResult = document.getElementById('prize-result');
            const prizeInput = document.getElementById('prize');
            
            // å¥–å“åˆ—è¡¨ - ä¸HTMLä¸­è½®ç›˜æ‰‡åŒºæ˜¾ç¤ºçš„å¥–å“ä¿æŒä¸€è‡´
            const prizes = ['å¥¶èŒ¶', 'å°è›‹ç³•', 'é¡¹é“¾', 'ç»™é˜¿å¸¸è¯´æ—©å®‰', 'é›¶é£Ÿç¤¼åŒ…', 'èŠ±'];
            let spinning = false;
            
            spinButton.addEventListener('click', function() {
                if (spinning) return;
                
                spinning = true;
                spinButton.disabled = true;
                prizeResult.textContent = '';
                
                // è®¡ç®—éšæœºæ—‹è½¬è§’åº¦ï¼ˆ5-8åœˆï¼‰
                const totalSpins = 5 + Math.random() * 3;
                const randomAngle = Math.random() * 360;
                const angle = totalSpins * 360 + randomAngle;
                
                // åº”ç”¨æ—‹è½¬åŠ¨ç”»
                wheel.style.transform = `rotate(${angle}deg)`;
                
                // åŠ¨ç”»ç»“æŸåè®¡ç®—å¹¶æ˜¾ç¤ºç»“æœ
                setTimeout(() => {
                    // è®¡ç®—æ—‹è½¬åçš„å®é™…è§’åº¦ï¼ˆå–æ¨¡360ï¼‰
                    const finalAngle = angle % 360;
                    
                    // ç¡®ä¿ç»“æœå‡†ç¡®è·ŸéšæŒ‡é’ˆä½ç½®
                    // æ¯ä¸ªæ‰‡åŒº60åº¦ï¼ŒæŒ‡é’ˆåœ¨é¡¶éƒ¨ä½ç½®
                    // è®¡ç®—æ–¹æ³•ï¼šä»é¡¶éƒ¨å¼€å§‹ï¼Œé¡ºæ—¶é’ˆè®¡ç®—å±äºå“ªä¸ªæ‰‡åŒº
                    let prizeIndex = Math.floor((360 - finalAngle) / 60) % prizes.length;
                    
                    // è°ƒæ•´ç´¢å¼•ä½¿å…¶ä¸HTMLä¸­æ‰‡åŒºçš„å®é™…é¡ºåºä¸€è‡´
                    // HTMLä¸­æ‰‡åŒºæ˜¯æŒ‰é¡ºæ—¶é’ˆæ’åˆ—çš„ï¼šå¥¶èŒ¶(0Â°)ã€å°è›‹ç³•(60Â°)ã€é¡¹é“¾(120Â°)ç­‰
                    prizeIndex = prizeIndex === 0 ? 0 : prizeIndex;
                    
                    const prize = prizes[prizeIndex];
                    prizeResult.textContent = `æ­å–œè·å¾—: ${prize}`;
                    prizeInput.value = prize;
                    spinning = false;
                    spinButton.disabled = false;
                }, 3000);
            });
            
            // æ¨¡æ€æ¡†è¡¨å•æäº¤å¤„ç†
            const modalForm = document.getElementById('modal-form');
            modalForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                // æ£€æŸ¥æ˜¯å¦å·²ç»æŠ½å¥–
                if (!prizeInput.value) {
                    alert('è¯·å…ˆè½¬åŠ¨å¹¸è¿è½®ç›˜ï¼');
                    return;
                }
                
                // è·å–è¡¨å•æ•°æ®
                const address = document.getElementById('address').value;
                const phone = document.getElementById('phone').value;
                const message = document.getElementById('milk-tea').value;
                const prize = prizeInput.value;
                
                // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æ•°æ®å¤„ç†é€»è¾‘
                console.log('åœ°å€:', address);
                console.log('æ‰‹æœºå·:', phone);
                console.log('æƒ³å¯¹é˜¿å¸¸è¯´çš„è¯:', message);
                console.log('å¥–å“:', prize);
                
                // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                const submitButton = this.querySelector('button[type="submit"]');
                const originalText = submitButton.textContent;
                submitButton.disabled = true;
                submitButton.textContent = 'å‘é€ä¸­...';
                
                try {
                    // å‡†å¤‡ç”¨æˆ·ä¿¡æ¯ç”¨äºé‚®ä»¶å‘é€
                    const userInfo = {
                        address: address,
                        phone: phone,
                        message: message,
                        prize: prize
                    };
                    
                    // è°ƒç”¨é‚®ä»¶å‘é€API
                    const emailResult = await sendEmail(userInfo);
                    console.log('é‚®ä»¶å‘é€ç»“æœ:', emailResult);
                    
                    // å‘é€æˆåŠŸæç¤º
                    alert(`ä¿¡æ¯å‘é€æˆåŠŸï¼\nå·²è®°å½•æ‚¨çš„ä¿¡æ¯\nåœ°å€: ${address}\næ‰‹æœºå·: ${phone}\næƒ³å¯¹é˜¿å¸¸è¯´çš„è¯: ${message}\nå¹¸è¿å¥–å“: ${prize}\n\næ˜å¤©å°†ä¸ºæ‚¨é€è¾¾å¹¸è¿ï¼`);
                    
                    // ä¿å­˜ä¿¡æ¯åˆ°æœ¬åœ°å­˜å‚¨
                    saveOrderData({
                        address: address,
                        phone: phone,
                        message: message
                    });
                } catch (error) {
                    // å¼‚å¸¸å¤„ç†
                    console.error('æäº¤è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:', error);
                    alert('æäº¤è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•');
                } finally {
                    // æ¢å¤æŒ‰é’®çŠ¶æ€
                    submitButton.disabled = false;
                    submitButton.textContent = originalText;
                    
                    // éšè—æ¨¡æ€æ¡†
                    const modal = document.getElementById('modal');
                    modal.classList.remove('active');
                }
            });
            
            // ä¿å­˜ä¿¡æ¯åˆ°localStorage
            function saveOrderData(data) {
                // è·å–ç°æœ‰ä¿¡æ¯æ•°æ®
                let messages = JSON.parse(localStorage.getItem('loveMessages') || '[]');
                
                // æ·»åŠ æ–°ä¿¡æ¯ï¼ŒåŒ…å«æ—¶é—´æˆ³
                const newMessage = {
                    ...data,
                    timestamp: new Date().toISOString()
                };
                
                // æ·»åŠ åˆ°æ•°ç»„å¼€å¤´ï¼ˆæœ€æ–°çš„åœ¨å‰é¢ï¼‰
                messages.unshift(newMessage);
                
                // ä¿å­˜å›localStorage
                localStorage.setItem('loveMessages', JSON.stringify(messages));
                
                // æ›´æ–°æ•°æ®é¢æ¿
                updateDataPanel();
                
                return newMessage;
            }
            
            // æ›´æ–°æ•°æ®é¢æ¿
            function updateDataPanel() {
                const dataPanel = document.getElementById('data-panel');
                if (!dataPanel) return; // å¦‚æœæ²¡æœ‰æ•°æ®é¢æ¿å…ƒç´ ï¼Œåˆ™ç›´æ¥è¿”å›
                
                // è·å–ä¿¡æ¯æ•°æ®
                const messages = JSON.parse(localStorage.getItem('loveMessages') || '[]');
                
                // æ¸…ç©ºç°æœ‰å†…å®¹
                dataPanel.innerHTML = '';
                
                // æ·»åŠ æ ‡é¢˜
                const title = document.createElement('h3');
                title.textContent = 'å¯¹é˜¿å¸¸çš„ç•™è¨€';
                dataPanel.appendChild(title);
                
                // å¦‚æœæ²¡æœ‰æ•°æ®ï¼Œæ˜¾ç¤ºæç¤ºä¿¡æ¯
                if (messages.length === 0) {
                    const noData = document.createElement('p');
                    noData.textContent = 'æš‚æ— ç•™è¨€æ•°æ®';
                    dataPanel.appendChild(noData);
                    return;
                }
                
                // åˆ›å»ºè¡¨æ ¼
                const table = document.createElement('table');
                table.className = 'data-table';
                
                // åˆ›å»ºè¡¨å¤´
                const thead = document.createElement('thead');
                const headerRow = document.createElement('tr');
                ['åœ°å€', 'æ‰‹æœºå·', 'ç•™è¨€å†…å®¹', 'æ—¶é—´'].forEach(text => {
                    const th = document.createElement('th');
                    th.textContent = text;
                    headerRow.appendChild(th);
                });
                thead.appendChild(headerRow);
                table.appendChild(thead);
                
                // åˆ›å»ºè¡¨æ ¼å†…å®¹
                const tbody = document.createElement('tbody');
                messages.forEach(message => {
                    const row = document.createElement('tr');
                    
                    // æ ¼å¼åŒ–æ—¶é—´
                    const formattedDate = new Date(message.timestamp).toLocaleString();
                    
                    // æ·»åŠ å•å…ƒæ ¼
                    [message.address, message.phone, message.message, formattedDate].forEach(text => {
                        const td = document.createElement('td');
                        td.textContent = text;
                        row.appendChild(td);
                    });
                    
                    tbody.appendChild(row);
                });
                table.appendChild(tbody);
                
                // æ·»åŠ åˆ°é¢æ¿
                dataPanel.appendChild(table);
            }
             
            // æ·»åŠ ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­æ¨¡æ€æ¡†çš„åŠŸèƒ½
            const modal = document.getElementById('modal');
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.classList.remove('active');
                }
            });
            
            // æ·»åŠ ç‚¹å‡»é‡æ–°æ’­æ”¾æ•ˆæœ
            document.addEventListener('click', function(e) {
                // å¦‚æœç‚¹å‡»çš„ä¸æ˜¯æŒ‰é’®ï¼Œæ‰é‡ç½®åŠ¨ç”»
                if (e.target !== yesButton) {
                    // é‡ç½®å¿ƒå½¢è·¯å¾„åŠ¨ç”»
                    const heartPath = document.getElementById('heart-path');
                    heartPath.style.animation = 'none';
                    void heartPath.offsetWidth; // è§¦å‘é‡æ’
                    heartPath.style.animation = 'drawHeart 3s ease-in-out forwards';
                    
                    // é‡ç½®å¡«å……åŠ¨ç”»
                    const heartFill = document.getElementById('heart-fill');
                    heartFill.style.animation = 'none';
                    void heartFill.offsetWidth;
                    heartFill.style.animation = 'fillHeart 1s ease-in forwards 3.2s';
                    
                    // é‡ç½®æ–‡å­—åŠ¨ç”»
                    const nameText = document.getElementById('name-text');
                    nameText.style.animation = 'none';
                    void nameText.offsetWidth;
                    nameText.style.animation = 'revealText 1s ease-out forwards 4s';
                    
                    // é‡ç½®å…‰æ•ˆåŠ¨ç”»
                    const glows = document.querySelectorAll('.background-glow');
                    glows.forEach((glow, index) => {
                        glow.style.animation = 'none';
                        void glow.offsetWidth;
                        const delay = index === 0 ? '3.5s' : '3.8s';
                        glow.style.animation = `glowAppear 1s ease-out forwards ${delay}`;
                    });
                    
                    // é‡ç½®æŒ‰é’®çŠ¶æ€
                    yesButton.style.animation = 'none';
                    void yesButton.offsetWidth;
                    yesButton.style.animation = 'revealButton 1s ease-out forwards 5s';
                    yesButton.disabled = false;
                    yesButton.style.opacity = '1';
                    yesButton.style.cursor = 'pointer';
                    
                    // ç§»é™¤æ‰€æœ‰ä¸‹è½çš„æ˜Ÿæ˜Ÿ
                    const fallingStars = document.querySelectorAll('.falling-star');
                    fallingStars.forEach(star => star.remove());
                }
            });
            
            // éŸ³ä¹åŠŸèƒ½å°†é€šè¿‡ä¸‹æ–¹çš„initMusicå‡½æ•°å®ç°
    
    // åˆå§‹åŒ–è®¡æ—¶å·¥å…·å…ƒç´ å¹¶è®¡ç®—å¤©æ•°
    function initCounter() {
        // è®¡ç®—é˜¿é›¯ä¸é˜¿å¸¸è®¤è¯†çš„å¤©æ•°å‡½æ•°
        function updateDaysCount() {
            // è®¾ç½®è®¤è¯†çš„èµ·å§‹æ—¥æœŸ (ä¿®æ”¹ä¸ºå®é™…æ—¥æœŸ)
            const startDate = new Date('2025-10-20'); // è¿™é‡Œå¯ä»¥è®¾ç½®ä¸ºå®é™…è®¤è¯†çš„æ—¥æœŸ
            const currentDate = new Date();
            
            // è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„æ¯«ç§’æ•°å·®
            const timeDiff = currentDate.getTime() - startDate.getTime();
            
            // è½¬æ¢ä¸ºå¤©æ•°å¹¶å‘ä¸Šå–æ•´ï¼ˆä¸è¶³ä¸€å¤©ç®—ä¸€å¤©ï¼‰
            const daysDiff = Math.ceil(timeDiff / (1000 * 3600 * 24));
            
            // æ›´æ–°æ˜¾ç¤º
            const daysCountElement = document.getElementById('days-count');
            if (daysCountElement) {
                daysCountElement.textContent = daysDiff;
            }
        }
        
        // åˆ›å»ºè®¡æ—¶å·¥å…·å®¹å™¨ï¼ˆéšè—çŠ¶æ€ï¼‰
        const counterDiv = document.createElement('div');
        counterDiv.id = 'daysCounter';
        counterDiv.style.cssText = 'position: fixed; top: 10px; left: 10px; right: 10px; z-index: 9999; background: #ff2e63; color: white; font-size: 24px; font-weight: bold; padding: 15px; text-align: center; border: 2px solid white; display: none;';
        
        // åˆ›å»ºæ–‡æœ¬å†…å®¹
        const text1 = document.createTextNode('é˜¿é›¯ä¸é˜¿å¸¸è®¤è¯†çš„ç¬¬ ');
        const daysSpan = document.createElement('span');
        daysSpan.id = 'days-count';
        daysSpan.textContent = '10';
        const text2 = document.createTextNode(' å¤©');
        
        // ç»„è£…å…ƒç´ 
        counterDiv.appendChild(text1);
        counterDiv.appendChild(daysSpan);
        counterDiv.appendChild(text2);
        
        // æ·»åŠ åˆ°body
        document.body.insertBefore(counterDiv, document.body.firstChild);
        
        // åˆå§‹è®¡ç®—å¤©æ•°
        updateDaysCount();
        
        // æ¯åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡å¤©æ•°
        setInterval(updateDaysCount, 60000);
    }
    
    // è°ƒç”¨è®¡æ—¶å·¥å…·åˆå§‹åŒ–å‡½æ•°
    initCounter();
});

// éŸ³ä¹åŠŸèƒ½
    console.log('éŸ³ä¹åŠŸèƒ½åˆå§‹åŒ–');
    
    // åˆ›å»ºéŸ³é¢‘å¯¹è±¡
    var audio = new Audio('../æ‹äºº.mp3');
    audio.volume = 0.5;
    audio.loop = true;
    
    // é”™è¯¯å¤„ç†
    audio.onerror = function(e) {
        console.error('éŸ³é¢‘åŠ è½½é”™è¯¯:', e);
    };
    
    // å°è¯•è‡ªåŠ¨æ’­æ”¾
    audio.play().then(function() {
        console.log('è‡ªåŠ¨æ’­æ”¾æˆåŠŸ');
    }).catch(function(err) {
        console.log('è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢ï¼Œç‚¹å‡»é¡µé¢æ’­æ”¾');
        document.onclick = function() {
            audio.play().then(function() {
                console.log('ç‚¹å‡»åæ’­æ”¾æˆåŠŸ');
            }).catch(function(e) {
                console.error('ç‚¹å‡»åæ’­æ”¾å¤±è´¥:', e);
            });
        };
    });
    
    console.log('éŸ³ä¹åŠŸèƒ½åˆå§‹åŒ–å®Œæˆ');
</script>
</body>
</html>
